---
title: "cartography-map-model-predictions_en"
output: html_document
---


<!-- 
1. cartography-for-modelling_en.Rmd
2. modelling-presence-absence-simplified_en.Rmd
3. cartography-map-model-predictions_en.Rmd
-->


# Objectives
The aim of this tutorial is to predict the distribution of flatfishes in the Vilaine Estuary (France).  

With this tutorial, you will have to (1) manipulate geographic data to prepare data necessary for the modelling procedure, (2) model average probability of presence of flatfishes on the study area and (3) produce maps of predictions of probabilities.  
*The 3 parts may be independant if needed.*

# Part 3: Realise maps of model predictions

## Load packages

Load necessary packages like {sf}, {dplyr}, {ggplot2}, {raster}, {rasterVis}

```{r LibrariesPA, purl=TRUE}





```

## Read dataset

- Read spatial dataset of stations with covariates:     
    + "carto-data-orig/vilaine/data_vilaine_covariates_correction_l93.shp"
- Transform as simple tibble for model exploration with `as_tibble`
- Transform columns `Presence` as logical (TRUE/FALSE)
- Transform columns `Year`, `Sedim`, `Zone`, `coasts` and `bathyclass` as character
- Store the result of these operations in an object named `dataset`

```{r R_LoadDataPA.T}








```

## Fit a presence-absence model

- The best model to predict average distribution is with "Zone" and "bathy"
```
glm1 <- glm(formula = Presence ~ as.character(Zone) + poly(bathy, 2),
  family = "binomial", data = dataset)
```
    
```{r}


```

## Predictions on raster

- Read raster for predictions in "carto-data-orig/vilaine/covar_raster_correction.grd"
    + This is a multi-layer raster, read it with `stack`
- From this stack, create a new stack containing only covariates of interest
- Calculate predictions for each cell of the raster

```{r}








```

- Plot the outputs

```{r}



















```

