---
title: "Simples fonctions"
output: formation::exo_rmd
params:
  hide:
    value: TRUE
  warning:
    value: FALSE
  message:
    value: FALSE
  results:
    value: 'hide'
  path: 
    value: "image/"
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(message = params$message, warning = params$warning, results = params$results, eval = FALSE)
library(knitr)
if (params$hide) {
  formation::hide_code()
}
```

# Create functions

Create a function call `all_csv` that takes a path, and lists all the csv contained in that folder. 

```{r}
all_csv <- function(path){
  list.files(path, pattern = "csv", full.names = TRUE)
}
all_csv("data")
```

Create `file size`, a function that takes a folder path, and returns the list of all the file sizes in this folder.

```{r}
library(dplyr)
library(magrittr)
tailles_fichiers <- function(path){
  list.files(path, full.names = TRUE) %>%
    lapply(file.size)
}
tailles_fichiers(".")
```

Create `size_folder_df` that takes a file, and returns a data.frame with the name of the file, and its size.

```{r}
size_folder_df <- function(file){
  data.frame(name = file, 
             size = file.size(file))
}
size_folder_df("analyse_facto.Rmd")
```

Create a function that takes a folder path, and returns a data.frame with the size of all the files in this folder.

```{r}
folder_df <- function(path){
    list.files(path, full.names = TRUE) %>%
    map_df(size_folder_df) 
}
folder_df(".")
```

Using tidyeval, add a parameter to `folder_df` so that the user can specify a name for the size column.

```{r}
search_folder_size <- function(path, name){
  name <- enquo(name)
  folder_df(path) %>% 
    rename(!!name := size)
}
search_folder_size(".", this)
```

Add a parameter to `search_folder_size_arrange` so that the user can arrange the size column. 

```{r}
search_folder_size_arrange <- function(path, name, arrange = FALSE){
  name <- enquo(name)
  df <- folder_df(path) %>% 
    rename(!!name := size) 
  if (arrange){
    df <- arrange(df, !! name)
  }
  df
}
search_folder_size_arrange(".", this, TRUE)
```

Add all these functions to a package! 
